# CORS란 무엇인가?

* 웹사이트(브라우저)에서 일어나는 일

* 요청을 막고 있는 것은 **SOP(Same-Origin-Policy)**, **CORS(Cross-Origin Resource Sharing)**는 SOP와 반대되는 개념으로 다른 출처간에 리소스를 공유할 수 있도록 허용해 주는 것을 말한다. (정보 요청과 반환이 가능하도록 하는 것)

리소스: 주고 받아지는 데이터, 출처: 보내고 받는 각각의 위치 즉, 웹사이트랑 API의 주소

# CORS의 목적

* 원래 서로 다른 출처끼리 요청을 주고 받는 건 안되는게 기본값이였다.(SOP) 
    -> 웹 생태계가 다양해면서 여러 서비스들간에 보다 자유롭게 데이터가 주고 받아질 필요가 생김

* 하지만 다른 사이트간의 요청은 브라우저가 막고 있으니까, 어떤 기준을 충족시키면 리소스가 공유가 되도록 만들어진 매커니즘이 CORS이다. (여기서 조건이란, 요청을 받는 백엔드 쪽에서 이걸 허락할 다른 출처들을 미리 명시)

# nodejs 기반의 웹 서버에서 CORS를 어떻게 설정하는지?

* 브라우저는 다른 출처끼리의 요청이 보내질 때는 요청에 origin이라는 header 추가

header: 데이터가 다른 곳으로 전송될 때 데이터의 맨 앞쪽에 붙은 보충 정보(우편 봉투같은 느낌)

* 다른 쪽 서버에서 답장 header에 Access-Control-Allow-Origin 정보를 실어서 보낸다.

* 토큰 등 사용자의 식별 정보가 담긴 요청에 대해서는 보다 엄격!!
    - 보내는 측의 요청 옵션에는 credentials 항목을 true로 셋팅
    - 받는 쪽에서도, 아무 출처나 다 허용시키는 것이아닌 보내는 측 출처(웹 주소)를 정확히 명시한 다음 Access-Control-Allow-Credentials 항목을 true로 설정

# simple request / preflight

* simple request: GET, POST 등 일정 조건의 요청에 의해 사용
* preflight: PUT, DELETE등 본 요청에 보내기전에 preflight 요청이란 걸 먼저 보내서 본요청이 안전한지 확인

